<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Riproduzione Audio</title>
    <style>
      body,
      html {
        height: 100%;
        margin: 0;
        background-color: #1a1a1a; /* Sfondo scuro elegante */
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: sans-serif;
        color: white;
        text-align: center;
      }

      /* Il pulsante che copre tutto lo schermo */
      #play-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 10;
        background: radial-gradient(circle, #333 0%, #000 100%);
      }

      .icon {
        font-size: 0;
        margin-bottom: 20px;
        background: #e74c3c; /* Colore rosso vivace */
        width: 120px;
        height: 120px;
        border-radius: 50%;
        box-shadow: 0 0 30px rgba(231, 76, 60, 0.6);
        transition: transform 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
      }

      /* Padding specifico solo per la freccia play */
      .icon.play-icon {
        padding-left: 8px;
      }

      /* Animazione pulsazione */
      .pulse {
        animation: pulse-animation 2s infinite;
      }

      @keyframes pulse-animation {
        0% {
          box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7);
        }
        70% {
          box-shadow: 0 0 0 30px rgba(231, 76, 60, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(231, 76, 60, 0);
        }
      }

      h1 {
        font-size: 24px;
        margin: 0 20px;
        font-weight: 300;
      }
      p {
        color: #aaa;
        font-size: 14px;
        margin-top: 10px;
      }

      /* Nascondiamo il player standard, non serve vederlo */
      audio {
        display: none;
      }
    </style>
  </head>
  <body>
    <audio id="myAudio" src="traccia2.mp3" preload="auto"></audio>

    <div id="play-overlay" onclick="startAudio()">
      <div class="icon play-icon pulse">
        <svg width="50" height="60" viewBox="0 0 50 60" fill="white">
          <polygon points="0,0 0,60 50,30" />
        </svg>
      </div>
      <h1 id="status-text">Tocca per ascoltare</h1>
      <p>Audio Guida</p>
    </div>

    <script>
      var audio = document.getElementById("myAudio");
      var overlay = document.getElementById("play-overlay");
      var text = document.getElementById("status-text");
      var icon = document.querySelector(".icon");

      // Tenta l'autoplay appena la pagina carica
      window.onload = function () {
        var playPromise = audio.play();

        if (playPromise !== undefined) {
          playPromise
            .then((_) => {
              // Autoplay riuscito! (Raro su mobile, possibile su PC)
              isPlayingState();
            })
            .catch((error) => {
              // Autoplay bloccato dal browser. Aspettiamo il click dell'utente.
              console.log("Autoplay bloccato. Attendo interazione utente.");
            });
        }
      };

      // Funzione chiamata quando l'utente clicca sullo schermo
      function startAudio() {
        if (audio.paused) {
          audio.play();
          isPlayingState();
        } else {
          audio.pause();
          isPausedState();
        }
      }

      function isPlayingState() {
        text.innerText = "In riproduzione...";
        icon.innerHTML = "II"; // Simbolo pausa
        icon.style.background = "#2ecc71"; // Diventa verde
        icon.style.fontSize = "80px";
        icon.classList.add("pulse");
        icon.classList.remove("play-icon"); // Rimuove padding per pausa
      }

      function isPausedState() {
        text.innerText = "Tocca per riprendere";
        icon.innerHTML = '<svg width="50" height="60" viewBox="0 0 50 60" fill="white"><polygon points="0,0 0,60 50,30" /></svg>';
        icon.style.background = "#e74c3c"; // Torna rosso
        icon.style.fontSize = "0";
        icon.classList.remove("pulse");
        icon.classList.add("play-icon"); // Aggiunge padding per play
      }

      // Se l'audio finisce, resetta lo stato
      audio.onended = function () {
        isPausedState();
        text.innerText = "Ascolto terminato";
      };
    </script>
  </body>
</html>
